### 网络请求方式

1. HTTP数据请求
   ——常用的请求方式，调服务端接口；无状态，响应式
2. WebSocket连接
   ——在线聊天、即时通信、数据刷新；低延迟，定时数据更新
3. Socket连接
   ——http上传下载，smtp邮件传输收发；tcp面向连接、udp无连接



### 网络权限

系统静态授权（工程里配置不需要手动配置）

+ ohos.permission.INTERNET
+ ohos.permission.GET_NETWORK_INFO：允许应用获取数据网络信息
  场景：wifi获取ip、dns
+ ohos.permission.SER_NETWORK_INFO：允许应用配置数据网络
  场景：有线网络连接配置ip、端口



### HTTP

> 针对一些地址字符串特殊字符，比如中文等，需要进行url转码
>
> ```ts
> let url = "https://www.baidu.com"
> const tempUrl = Url.URL.parseURL(url);
> url = tempUrl.toString();
> ```



请求结束不管是否error都记得销毁：`httpRequest.destroy()`



> GET请求使用extraData、expectDataType可能会产生报错，某些网站服务器不支持拼接这些内容



### WebSocket

+ 连接远端服务（connect）
+ 发送消息
+ 关闭连接



| 接口名               | 描述                                      |
| :------------------- | :---------------------------------------- |
| createWebSocket()    | 创建一个WebSocket连接。                   |
| connect()            | 根据URL地址，建立一个WebSocket连接。      |
| send()               | 通过WebSocket连接发送数据。               |
| close()              | 关闭WebSocket连接。                       |
| on(type: 'open')     | 订阅WebSocket的打开事件。                 |
| off(type: 'open')    | 取消订阅WebSocket的打开事件。             |
| on(type: 'message')  | 订阅WebSocket的接收到服务器消息事件。     |
| off(type: 'message') | 取消订阅WebSocket的接收到服务器消息事件。 |
| on(type: 'close')    | 订阅WebSocket的关闭事件。                 |
| off(type: 'close')   | 取消订阅WebSocket的关闭事件               |
| on(type: 'error')    | 订阅WebSocket的Error事件。                |
| off(type: 'error')   | 取消订阅WebSocket的Error事件。            |





### Sokect

+ 绑定本地IP地址和端口（bind）
+ 连接远端IP地址和端口（connect）
+ 发送消息（send）
+ 关闭连接（close）
+ 查看连接状态（getState）



> 充电桩用udp比较多



> 有些通过service框架层napi回调出来的对象不是一个能被JSON.stringify()标准化的对象，打印不出来，会显示为空



### Request

@ohos.request

+ 上传文件
+ 下载资源



> 上传文件时要将文件放在沙箱路径cache文件夹下，因为4.0中UploadConfig中的uri填文件的本地存储路径时，仅支持"internal"协议类型，"internal://cache/"为应用的私有目录，是必填字段，示例：`internal://cache/path/to/file.txt`
>
> > 物理路径：/data/app/el2/100/base/com.exapmle.openharmonynetwork/haps/entry/cache/videolist.json
> >
> > 沙箱路径：/data/storage/el2/base/haps/entry/cache/videolist.json



