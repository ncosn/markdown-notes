### 页面路由（router）

#### 页面跳转

Router模块提供两种跳转模式，分别是`router.pushUrl()`和`router.replaceUrl()`。

+ router.pushUrl()：目标页面不会替换当前页，而是压入页面栈。这样可以保留当前页的状态，并且可以通过返回键或调用router.back()方法返回到当前页。
+ router.replaceUrl()：目标页面不会替换当前页，并销毁当前页。这样可以释放当前页的资源，并且无法返回到当前页。

> **说明：**
>
> + 页面栈的最大容量为32个页面。如果超过这个限制，可以调用router.clear()方法清空历史页面栈，释放内存空间。

同时，Router模块提供了两种实例模式，分别是Standard和Single。这两种模式决定了目标是否会对应多分实例。

+ Standard：多实例模式，也是默认情况下的跳转模式。目标页面会被添加到页面栈顶，无论栈中是否存在相同url的页面。
+ Single：单实例模式。如果目标页面的url已经存在于页面栈中，则会**将离栈顶最近的同url页面移动的栈顶，该页面成为新建页**。如果目标页面的url在页面栈中不存在同url页面，则按照默认的多实例模式进行跳转。



#### 页面返回

当用户在一个页面完成操作后，通常需要返回到上一个页面或指定页面，需要用到页面返回功能。在返回过程中可能需要传递数据给目标页面，这就需要用到数据传递功能。

+ 方式一：返回到上一个页面

  ```ts
  router.back();
  ```

  这种方式会返回到上一个页面，即上一个页面在页面栈中的位置。但是，上一个页面必须存在于页面栈中才能够返回，否则该方法将无效。

+ 方式二：返回到指定页面

  返回普通页面。

  ```ts
  router.back({
      url: 'pages/Home',
      params: {
          info: '来自Home页'
      }
  });
  ```

  返回命名路由页面。

  ```ts
  router.back({
      url: 'myPage',//myPage为返回的命名路由页面别名
      params: {
          info: '来自Home页'
      }
  })
  ```

  这种方式不仅可以返回到指定页面，还可以在返回的同时传递自定义参数信息。这些参数信息可以在目标页面中通过router.getParams()方法进行获取和解析。

> **说明：**
>
> 当使用router.back()方法返回到指定页面时，原栈顶页面（包括）到指定页面（不包括）之间的所有页面栈都将从栈中弹出并销毁。
>
> 另外，如果使用router.back()方法返回到原来的页面，原页面不会被重复创建，因此使用@State声明的变量不会重复声明，也不会触发页面的aboutToAppear()生命周期回调。如果需要在原页面中使用返回页面传递的自定义参数，可以在需要的位置进行参数解析。例如，在onPageShow()生命周期回调中进行参数解析。



### 页面转场动画

推荐**导航转场**和**模态转场**



#### 导航转场

页面跳转包括两部分：一个页面消失，另一个页面出现。

页面转场效果写在`pageTransition`函数中

```ts
pageTransition() {
  PageTransitionEnter({ type: RouteType.None, duration: 0 })
  PageTransitionExit({ type: RouteType.None, duration: 0 })
}
```



PageTransitionEnter的接口为：

```ts
PageTransitionEnter({type?: RouteType,duration?: number,curve?: Curve | string,delay?: number})
```

PageTransitionExit的接口为：

```ts
PageTransitionExit({type?: RouteType,duration?: number,curve?: Curve | string,delay?: number})
```

> 上述接口中的参数type，表示路由生效的类型。
>
> 页面的PageTransitionEnter既可能是由于新增页面(push，入栈)引起的新页面的入场动画，也可能是由于页面返回(back，或pop，出栈)引起的页面栈中老页面的入场动画，为了能区分这两种形式的入场动画，提供了type参数，这样开发者能完全定义所有类型的页面转场效果。